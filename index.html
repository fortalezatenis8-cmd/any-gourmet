<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Any Gourmet | Fix Final</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-stone-50 p-6 text-stone-800">
    <div class="max-w-md mx-auto bg-white p-8 rounded-[2.5rem] shadow-xl border border-stone-100">
        <h1 class="text-2xl font-bold text-center mb-2 italic">Any Gourmet</h1>
        <div id="status" class="text-[10px] text-center uppercase tracking-widest text-stone-400 mb-8 font-bold">Verificando...</div>

        <div id="area-login" class="space-y-4">
            <input type="email" id="email" placeholder="E-mail" class="w-full p-4 bg-stone-50 rounded-2xl border outline-none focus:border-stone-200">
            <input type="password" id="pass" placeholder="Senha" class="w-full p-4 bg-stone-50 rounded-2xl border outline-none focus:border-stone-200">
            <button onclick="tentarLogin()" class="w-full bg-stone-900 text-white p-5 rounded-2xl font-bold uppercase text-xs tracking-widest shadow-lg">Entrar no Painel</button>
        </div>

        <div id="painel-adm" class="hidden space-y-4">
            <div class="bg-green-50 p-4 rounded-2xl text-green-700 text-xs font-bold text-center">✅ ACESSO LIBERADO!</div>
            <button onclick="location.reload()" class="w-full text-stone-400 text-[10px] font-bold uppercase">Sair</button>
        </div>
    </div>

    <script>
        const URL_PROJETO = 'https://apsbsqmtjisrnvfrgkwe.supabase.co';
        // A chave abaixo já é a que enviaste, com limpeza de espaços automática
        const KEY_PROJETO = 'EyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImFwc2JzcW10amlzcm52ZnJna3dlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjYyNDc1MDAsImV4cCI6MjA4MTgyMzUwMH0.QzfXkwLiqRloFcTiezGlEjqkt9aNqgCywFhjsihQk-g'.trim();

        const _supa = supabase.createClient(URL_PROJETO, KEY_PROJETO);

        async function verificarConexao() {
            const { data, error } = await _supa.from('Doces').select('*').limit(1);
            const status = document.getElementById('status');
            if (error) {
                status.innerText = "ERRO: " + error.message;
                status.className = "text-[10px] text-center uppercase tracking-widest text-red-500 font-bold mb-8";
            } else {
                status.innerText = "CONECTADO AO BANCO";
                status.className = "text-[10px] text-center uppercase tracking-widest text-green-500 font-bold mb-8";
            }
        }

        async function tentarLogin() {
            const email = document.getElementById('email').value;
            const password = document.getElementById('pass').value;
            
            const { error } = await _supa.auth.signInWithPassword({ email, password });

            if (error) {
                alert("ERRO NO LOGIN:\nStatus: " + error.status + "\nMensagem: " + error.message);
            } else {
                document.getElementById('area-login').classList.add('hidden');
                document.getElementById('painel-adm').classList.remove('hidden');
                alert("Sucesso! O teu login funcionou.");
            }
        }

        verificarConexao();
    </script>
</body>
</html>

